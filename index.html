<!DOCTYPE html>
<html>

<head>
    <title>CSE 5544 Midterm Project</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
    </style>
</head>

<body>

    <div style="display: flex; flex-direction: column; align-items: center">
        <div style="width: 790px; height: 400px; border: black 5px solid; display: inline-block; margin: 5px">
            <img width='790px' height='400px' src='baseballField.png' usemap='#fieldmap'/>
            <map name="fieldmap">
                <area id="LF" shape="circle" coords="200,110,30" onclick="printPosition('Left Field clicked!')">
                <area id="CF" shape="circle" coords="395,60,30" onclick="printPosition('Center Field clicked!')">
                <area id="RF" shape="circle" coords="590,115,30" onclick="printPosition('Right Field clicked!')">
                <area id="3B" shape="circle" coords="270,205,30" onclick="printPosition('Third Base clicked!')">
                <area id="SS" shape="circle" coords="335,165,30" onclick="printPosition('Short Stop clicked!')">
                <area id="2B" shape="circle" coords="455,170,30" onclick="printPosition('Second Base clicked!')">
                <area id="1B" shape="circle" coords="515,210,30" onclick="printPosition('First Base clicked!')">
                <area id="P" shape="circle" coords="395,245,30" onclick="printPosition('Pitcher clicked!')">
                <area id="C" shape="circle" coords="395,340,30" onclick="printPosition('Catcher clicked!')">
            </map>
        </div>
        <div style="width: 790px; height: 350px; border: black 5px solid; display: inline-block; margin: 5px">

        </div>
    </div>

    <script type="text/javascript">
        // initialize variables -----------------------------------------------------

        // current selected year. default is 2017, but will be selectable eventually
        var currentYear = '2017';
        // battingDataFiltered will contain players from AL and NL leagues,
        // and players with over 400 at bats 
        var battingDataFiltered;
        // battingCurrentYear will be battingDataFiltered filtered to contain players
        // from whatever the currentYear variable is
        var battingCurrentYear;
        // peopleDataFiltered will contain players from AL and NL leagues
        var peopleDataFiltered;
        // peopleCurrentYear will be peopleDataFiltered filtered to contain players
        // from whatever the currentYear variable is
        var peopleCurrentYear;

        // end of variable declarations ---------------------------------------------

        // function definitions -----------------------------------------------------

        // temp function
        function printPosition(pos) {
            alert(pos);
        }

        // end of function definitions ----------------------------------------------

        // data loading and formatting ----------------------------------------------

        // load people csv
        d3.csv("./data/People.csv", function (d, i, columns) {
            return d;
        }, function (error, data) {
            if (error) throw error;
            var cols = data.columns;

            // only consider players in modern leagues, American League and National League
            peopleDataFiltered = data.filter(function(val) {
                return val.lgID == 'AL' || val.lgID == 'NL';
            });

            // filter out for 2017
            peopleCurrentYear = peopleDataFiltered.filter(function(val) {
                return val.yearID == currentYear;
            });
        });

        // load batting csv
        d3.csv("./data/Batting.csv", function (d, i, columns) {
            // calculate batting average
            var battingAvg = d.H / d.AB;
            d.BA = battingAvg.toFixed(3);
            return d;
        }, function (error, data) {
            if (error) throw error;
            var cols = data.columns;

            // only consider players who had at least 400 at bats
            battingDataFiltered = data.filter(function(val) {
                return (parseInt(val.AB) > 400);
            });

            // only consider players in modern leagues, American League and National League
            battingDataFiltered = battingDataFiltered.filter(function(val) {
                return val.lgID == 'AL' || val.lgID == 'NL';
            });

            // filter out for 2017
            battingCurrentYear = battingDataFiltered.filter(function(val) {
                return val.yearID == currentYear;
            });

            // sort 2017 data to be ordered from highest batting average to lowest
            battingCurrentYear.sort(function (a, b) { return b.BA - a.BA; });
        });

        // load fielding csv
        d3.csv("./data/Fielding.csv", function (d, i, columns) {
            return d;
        }, function (error, data) {
            if (error) throw error;
            var cols = data.columns;
        });

        // end data loading and formatting ------------------------------------------
    </script>

</body>

</html>